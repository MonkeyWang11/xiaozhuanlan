<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export3.dtd">
<en-export export-date="20181125T070336Z" application="Evernote" version="Evernote Mac 8.3.1 (457436)">
<note><title>6、约束</title><content><![CDATA[<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note><div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">（1）约束类型</span></font></div><hr /><ul><li><div>约束分为表级约束和列级约束</div></li><ul><li><div>列级约束：对一个数据列的约束（列级约束可以在列定义时声明，也可以在列定义后声明）</div></li><li><div>表级约束：对多个数据列的约束（标记约束只能在列定义后声明）</div></li></ul><li><div>约束类型</div></li><ul><li><div>NOT NULL非空约束</div></li><li><div>PRIMARY KEY主键约束</div></li><li><div>UNIQUE KEY唯一约束</div></li><li><div>DEFAULT默认约束</div></li><li><div>FOREIGN KEY外键约束</div></li></ul></ul><div><br /></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">（2）非空约束</span></font></div><hr /><ul><li><div>NULL和NOT NULL</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql&gt; create table tb2(</div><div>    -&gt; <font color="#ff2600">username varchar(20) not null</font>,</div><div>    -&gt; <font color="#ff2600">age tinyint unsigned null</font></div><div>    -&gt; );</div><div>Query OK, 0 rows affected (0.07 sec)</div><div><br /></div><div>mysql&gt; show columns from tb2;</div><div>+----------+---------------------+------+-----+---------+-------+</div><div>| Field    | Type                | Null | Key | Default | Extra |</div><div>+----------+---------------------+------+-----+---------+-------+</div><div>| username | varchar(20)         | NO   |     | NULL    |       |</div><div>| age      | tinyint(3) unsigned | YES  |     | NULL    |       |</div><div>+----------+---------------------+------+-----+---------+-------+</div><div>2 rows in set (0.00 sec)</div><div><br /></div><div>mysql&gt; insert tb2 values('TOm',null);</div><div>Query OK, 1 row affected (0.10 sec)</div><div><br /></div><div>mysql&gt; select * from tb2;</div><div>+----------+------+</div><div>| username | age  |</div><div>+----------+------+</div><div>| TOm      | NULL |</div><div>+----------+------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div>mysql&gt; insert tb2 values(<font color="#ff2600">null</font>,20);</div><div>ERROR 1048 (23000): <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Column 'username' cannot be null</span></div></div><div><br /></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">（3）主键约束</span></font></div><hr /><ul><li><div>每张表只能存在一个主键</div></li><li><div>主键自动为NOT NULL</div></li><li><div>主键约束保证记录的唯一性</div></li><li><div>AUTO_INCREMNET自动编号的必须与主键组合使用，但主键可以单独使用</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql&gt; create table tb4(</div><div>    -&gt; <font color="#ff2600">id smallint unsigned <b>primary key auto_increment</b>,</font></div><div>    -&gt; username varchar(30) not null</div><div>    -&gt; );</div><div>Query OK, 0 rows affected (0.03 sec)</div><div><br /></div><div>mysql&gt; show columns from tb4;</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>| Field    | Type                 | Null | Key | Default | Extra          |</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>| id       | smallint(5) unsigned | NO   | <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">PRI</span> | NULL    | <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">auto_increment</span> |</div><div>| username | varchar(30)          | NO   |     | NULL    |                |</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>2 rows in set (0.00 sec)</div><div><br /></div><div>mysql&gt; insert tb4 (username) values('jack');</div><div>Query OK, 1 row affected (0.01 sec)</div><div><br /></div><div>mysql&gt; insert tb4 (username) values('rose');</div><div>Query OK, 1 row affected (0.06 sec)</div><div><br /></div><div>mysql&gt; select * from tb4;</div><div>+----+----------+</div><div>| id | username |</div><div>+----+----------+</div><div>|  <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">1</span> | jack     |</div><div>|  <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">2</span> | rose     |</div><div>+----+----------+</div><div>2 rows in set (0.00 sec)</div></div><div><ul><li><div>主键无需与AUTO_INCREMNET，但不能重复</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql&gt; CREATE TABLE tb4(</div><div>    -&gt; <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">id SMALLINT PRIMARY KEY,</span></b></span></div><div>    -&gt; name VARCHAR(20)</div><div>    -&gt; );</div><div>Query OK, 0 rows affected (0.07 sec)</div><div><br /></div><div>mysql&gt; SHOW COLUMNS FROM tb4;</div><div>+-------+-------------+------+-----+---------+-------+</div><div>| Field | Type        | Null | Key | Default | Extra |</div><div>+-------+-------------+------+-----+---------+-------+</div><div>| id    | smallint(6) | NO   | PRI | NULL    |       |</div><div>| name  | varchar(20) | YES  |     | NULL    |       |</div><div>+-------+-------------+------+-----+---------+-------+</div><div>2 rows in set (0.01 sec)</div><div><br /></div><div>mysql&gt; INSERT tb4 VALUES(<span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">22</span></b></span>,'a');</div><div>Query OK, 1 row affected (0.13 sec)</div><div><br /></div><div>mysql&gt; INSERT tb4 VALUES(21,'a');</div><div>Query OK, 1 row affected (0.04 sec)</div><div><br /></div><div>mysql&gt; INSERT tb4 VALUES(<span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">22</span></b></span>,'a');</div><div>ERROR 1062 (23000): <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Duplicate entry '22' for key 'PRIMARY'</span></b></span></div><div><br /></div><div>mysql&gt; SELECT * FROM tb4;</div><div>+----+------+</div><div>| id | name |</div><div>+----+------+</div><div>| 21 | a    |</div><div>| 22 | a    |</div><div>+----+------+</div><div>2 rows in set (0.00 sec)</div></div></div><div><br /></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">（4）唯一约束</span></font></div><hr /><ul><li><div>唯一约束可以保证记录的唯一性</div></li><li><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">唯一约束的字段可以为NULL，只能有一个NULL</span></div></li><li><div>一张表可以存在多个唯一约束（与主键的区别）</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql11&gt;CREATE TABLE tb5(</div><div>    -&gt; id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,</div><div>    -&gt; username VARCHAR(20) NOT NULL <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">UNIQUE KEY</span></b></span>,</div><div>    -&gt; age TINYINT UNSIGNED);</div><div>Query OK, 0 rows affected (0.06 sec)</div><div><br /></div><div>mysql11&gt;SHOW COLUMNS FROM tb5;</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>| Field    | Type                 | Null | Key | Default | Extra          |</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>| id       | smallint(5) unsigned | NO   | PRI | NULL    | auto_increment |</div><div>| username | varchar(20)          | NO   | <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">UNI</span></b></span> | NULL    |                |</div><div>| age      | tinyint(3) unsigned  | YES  |     | NULL    |                |</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>3 rows in set (0.01 sec)</div><div><br /></div><div>mysql11&gt;INSERT tb5(username,age) VALUES('Tom',22);</div><div>Query OK, 1 row affected (0.03 sec)</div><div><br /></div><div>mysql11&gt;INSERT tb5(username,age) VALUES('Tom',22);</div><div>ERROR 1062 (23000): <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Duplicate entry 'Tom' for key 'username'</span></b></span></div><div>mysql11&gt;select * from tb5;</div><div>+----+----------+------+</div><div>| id | username | age  |</div><div>+----+----------+------+</div><div>|  1 | Tom      |   22 |</div><div>+----+----------+------+</div><div>1 row in set (0.00 sec)</div></div><div><br /></div><div><span style="font-size: 18px; font-weight: bold;">（5）默认约束</span></div><hr /><ul><li><div>插入记录时，如果没有为字段赋值，则自动赋予默认值</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql11&gt;CREATE TABLE tb6(</div><div>    -&gt; id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,</div><div>    -&gt; username VARCHAR(20) NOT NULL UNIQUE KEY,</div><div>    -&gt; sex <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">ENUM('1','2','3') DEFAULT '3'</span></b></span></div><div>    -&gt; );</div><div>Query OK, 0 rows affected (0.06 sec)</div><div><br /></div><div>mysql11&gt;SHOW COLUMNS FROM tb6;</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>| Field    | Type                 | Null | Key | <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Default</span></b></span> | Extra          |</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>| id       | smallint(5) unsigned | NO   | PRI | NULL    | auto_increment |</div><div>| username | varchar(20)          | NO   | UNI | NULL    |                |</div><div>| sex      | enum('1','2','3')    | YES  |     | <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">3 </span></b></span>      |                |</div><div>+----------+----------------------+------+-----+---------+----------------+</div><div>3 rows in set (0.01 sec)</div><div><br /></div><div>mysql11&gt;INSERT tb6(username) VALUES('Tom');</div><div>Query OK, 1 row affected (0.03 sec)</div><div><br /></div><div>mysql11&gt;select * from tb6;</div><div>+----+----------+------+</div><div>| id | username | sex  |</div><div>+----+----------+------+</div><div>|  1 | Tom      | <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">3</span></b></span>    |</div><div>+----+----------+------+</div><div>1 row in set (0.00 sec)</div></div><div><br /></div><div><span style="font-size: 18px; font-weight: bold;">（6）外键约束</span></div><hr /><ul><li><div>外键约束的要求</div></li><ul><li><div>子表和父表必须使用相同的储存引擎，并且禁止使用临时表</div></li><li><div>数据表的存储引擎只能为InnoDB</div></li><li><div>外键列和参照列必须具有相似的数据类型。其中<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">数字的长度或是否有符号位必须相同</span>；而字符的长度则可以不同</div></li><li><div>外键列（子表）和参照列（父表）必须创建索引。如果外键列不存在索引的话，MySQl自动创建索引</div></li></ul></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql&gt; <font color="#ff2600">create table province(</font></div><div>    -&gt; <font color="#ff2600">id smallint unsigned primary key auto_increment,</font></div><div>    -&gt; <font color="#ff2600">pname varchar(20) not null</font></div><div>    -&gt; <font color="#ff2600">);</font></div><div>Query OK, 0 rows affected (0.02 sec)</div><div><br /></div><div><font color="#ff2600"><b>//主键会自动创建索引</b></font></div><div>mysql&gt; show create table province;</div><div>+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</div><div>| Table    | Create Table                                                                                                                                                                                           |</div><div>+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</div><div>| province | CREATE TABLE `province` (</div><div>  `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,</div><div>  `pname` varchar(20) NOT NULL,</div><div>  <font color="#ff2600">PRIMARY KEY (`id`)</font></div><div>) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci |</div><div>+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div><b><font color="#ff2600">//外键列和参照列必须类型一致</font></b></div><div>mysql&gt; create table city(</div><div>    -&gt; id smallint unsigned primary key auto_increment,</div><div>    -&gt; cname varchar(10) not null,</div><div>    -&gt; <font color="#ff2600">pid bigint</font>,</div><div>    -&gt; foreign key (pid) references province (id)</div><div>    -&gt; );</div><div>ERROR 1215 (HY000): Cannot add foreign key constraint</div><div>mysql&gt; create table city(</div><div>    -&gt; id smallint unsigned primary key auto_increment,</div><div>    -&gt; cname varchar(10) not null,</div><div>    -&gt; <font color="#ff2600">pid smallint,</font></div><div>    -&gt; foreign key (pid) references province (id)                                   </div><div>    -&gt; );</div><div>ERROR 1215 (HY000): Cannot add foreign key constraint</div><div><br /></div><div>mysql&gt; create table city(</div><div>    -&gt; id smallint unsigned primary key auto_increment,</div><div>    -&gt; cname varchar(10) not null,</div><div>    -&gt; <font color="#ff2600">pid smallint unsigned</font>,</div><div>    -&gt; <font color="#ff2600">foreign key (pid) references province (id)</font>                                   </div><div>    -&gt; );</div><div>Query OK, 0 rows affected (0.12 sec)</div><div><br /></div><div><font color="#ff2600"><b>// 如果外键列不存在索引的话，MySQl自动创建索引</b></font></div><div>mysql&gt; show create table city;</div><div>+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</div><div>| Table | Create Table                                                                                                                                                                                                                                                                                                                                    |</div><div>+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</div><div>| city  | CREATE TABLE `city` (</div><div>  `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,</div><div>  `cname` varchar(10) NOT NULL,</div><div>  `pid` smallint(5) unsigned DEFAULT NULL,</div><div>  <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">PRIMARY KEY (`id`),</span></div><div>  <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><font color="#ff2600">KEY `pid` (`pid`),</font></span></div><div>  <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">CONSTRAINT `city_ibfk_1` FOREIGN KEY (`pid`) REFERENCES `province` (`id`)</span></div><div>) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci |</div><div>+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</div><div>1 row in set (0.00 sec)</div><div><div><br /></div></div><div>mysql&gt; <b><font color="#ff2600">show indexes from province;</font></b></div><div>+----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</div><div>| Table    | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |</div><div>+----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</div><div>| province |          0 | PRIMARY  |            1 | <font color="#ff2600">id</font>          | A         |           0 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |</div><div>+----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</div><div>1 row in set (0.06 sec)</div><div><br /></div><div>mysql&gt; <b><font color="#ff2600">show indexes from city;</font></b></div><div>+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</div><div>| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |</div><div>+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</div><div>| city  |          0 | PRIMARY  |            1 | <font color="#ff2600">id</font>          | A         |           0 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |</div><div>| city  |          1 | pid      |            1 | <font color="#ff2600">pid</font>         | A         |           0 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |</div><div>+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</div><div>2 rows in set (0.04 sec)</div></div><ul><li><div>外键约束的默认数据联系</div></li><ul><li><div>父表的参照列有数据后，子表的外键列才可以添加数据</div></li><li><div>父表和子表有对应数据后，只有子表的数据删除之后才能删除父表的数据</div></li></ul></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql&gt; insert city (cname,pid) values('hefei',1);</div><div>ERROR 1452 (23000): <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><font color="#ff2600">Cannot add or update a child row: a foreign key constraint fails (`t1`.`city`, CONSTRAINT `city_ibfk_1` FOREIGN KEY (`pid`) REFERENCES `province` (`id`))</font></span></div><div>mysql&gt; <font color="#ff2600">insert province (pname) values('anhui');</font></div><div>Query OK, 1 row affected (0.05 sec)</div><div><br /></div><div>mysql&gt; select * from province;</div><div>+----+-------+</div><div>| id | pname |</div><div>+----+-------+</div><div>|  1 | anhui |</div><div>+----+-------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div>mysql&gt; <font color="#ff2600">insert city (cname,pid) values('hefei',1);</font></div><div>Query OK, 1 row affected (0.09 sec)</div><div><br /></div><div>mysql&gt; select * from city;</div><div>+----+-------+------+</div><div>| id | cname | pid  |</div><div>+----+-------+------+</div><div>|  2 | hefei |    1 |</div><div>+----+-------+------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div>mysql&gt; delete from province where id=1;</div><div>ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`t1`.`city`, CONSTRAINT `city_ibfk_1` FOREIGN KEY (`pid`) REFERENCES `province` (`id`))</div><div><br /></div><div>mysql&gt; delete from city where id=1;</div><div>Query OK, 0 rows affected (0.00 sec)</div><div><br /></div><div>mysql&gt; select * from city;</div><div>Empty set (0.00 sec)</div><div><div><br /></div></div><div>mysql&gt; delete from province where id=1;</div><div>Query OK, 1 row affected (0.02 sec)</div></div><ul><li><div>外键约束的参照操作</div></li><ul><li><div>CASCADE：从父表删除/更新后自动更新子表中匹配的行</div></li><li><div>SET NULL：<span style="font-size: 13px; font-family: Verdana;">从父表删除/更新后自</span><span style="font-size: 13px; font-family: Verdana;">设置子表中的外键列为NULL（</span><span style="font-size: 13px; font-family: Verdana;">使用该选项的前提是子表列没有指定NOT NULL</span><span style="font-size: 13px; font-family: Verdana;">）</span></div></li><li><div>RESTRICT：拒绝对父表的删除更新操作</div></li><li><div>NO ACTION：标准SQL关键字，与RESTRICT相同</div></li></ul><li><div>on delete cascade</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql&gt; create table city1(</div><div>    -&gt; id smallint unsigned primary key auto_increment,</div><div>    -&gt; cname varchar(20) not null,</div><div>    -&gt; pid smallint unsigned,</div><div>    -&gt; foreign key (pid) references province (id) <b><font color="#ff2600" style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">on delete cascade</font></b>                 </div><div><span>    </span>-&gt; );</div><div>Query OK, 0 rows affected (0.02 sec)</div><div><br /></div><div>mysql&gt; select * from province;</div><div>+----+---------+</div><div>| id | pname   |</div><div>+----+---------+</div><div>|  <font color="#ff2600">2</font> | beijing |</div><div>+----+---------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div>mysql&gt; select * from city1;</div><div>+----+-------+------+</div><div>| id | cname | pid  |</div><div>+----+-------+------+</div><div>|  3 | tom   |    <font color="#ff2600">2</font> |</div><div>+----+-------+------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div>mysql&gt; delete from province where id=2;</div><div>Query OK, 1 row affected (0.02 sec)</div><div><br /></div><div>mysql&gt; select * from city1;</div><div><font color="#ff2600" style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Empty set (0.00 sec)</font></div></div><ul><li><div>外键约束的on delete set null</div></li><ul><li><div><span style="font-size: 13px; font-family: Verdana;">从父表删除或者更新行，则设置子表中的外键列为NULL.使用该选项的前提是子表列没有指定NOT NULL</span></div></li></ul></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>mysql&gt; create table city2(                                                          </div><div><span>    </span>-&gt; id smallint unsigned primary key auto_increment,</div><div>    -&gt; cname varchar(20) not null,</div><div>    -&gt; pid smallint unsigned,</div><div>    -&gt; foreign key (pid) references province (id) <b><font color="#ff2600" style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">on delete set null</font></b>                </div><div><span>    </span>-&gt; );</div><div>Query OK, 0 rows affected (0.09 sec)</div><div><br /></div><div>mysql&gt; insert province (pname) values('shanghai');</div><div>Query OK, 1 row affected (0.02 sec)</div><div><br /></div><div>mysql&gt; select * from province;</div><div>+----+----------+</div><div>| id | pname    |</div><div>+----+----------+</div><div>|  3 | shanghai |</div><div>+----+----------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div>mysql&gt; insert city2 (cname,pid) values('baoshan',3);</div><div>Query OK, 1 row affected (0.02 sec)</div><div><br /></div><div>mysql&gt; select * from city2;</div><div>+----+---------+------+</div><div>| id | cname   | pid  |</div><div>+----+---------+------+</div><div>|  1 | baoshan |    3 |</div><div>+----+---------+------+</div><div>1 row in set (0.00 sec)</div><div><br /></div><div>mysql&gt; delete from province where id = 3;</div><div>Query OK, 1 row affected (0.10 sec)</div><div><br /></div><div>mysql&gt; select * from city2;</div><div>+----+---------+------+</div><div>| id | cname   | pid  |</div><div>+----+---------+------+</div><div>|  1 | baoshan | <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><font color="#ff2600">NULL</font></span> |</div><div>+----+---------+------+</div><div>1 row in set (0.00 sec)</div></div><div><br /></div><div><br /></div></div><div><br /></div></en-note>]]></content><created>20170215T022745Z</created><updated>20181125T062634Z</updated><note-attributes><author>372251027@qq.com</author><source>desktop.win</source><source-application>evernote.win32</source-application><reminder-order>0</reminder-order></note-attributes></note>
</en-export>
